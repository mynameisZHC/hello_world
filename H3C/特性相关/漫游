漫游

漫游定义：
在不同AP（Access Point，接入点）提供相同SSID（Service Set Identifier，服务集标识）服务区域中，WLAN客户端从一个AP上接入转移到另一个AP上接入的过程称为漫游
走BTM切换流程，终端会向新的终端直接发起reassociation而不是auth+association流程；终端平滑处理，用户无感知

漫游条件：
终端上线时根据beacon报文中名为“802.11v BSS Transition Management Information”字段判断此终端是否支持802.11V的能力

漫游检测：
每隔2s会调用iwh3c ra* h3c get_sta_list通过ioctl去内核态SDK中获取此终端对应的RSSI值(此RSSI值是由驱动接受到终端比如NULL DATA保活报文时的信号强度计算出来的)

漫游判决：
根据获取的此终端此刻的RSSI值跟通过实际情况和经验设置的漫游阈值进行比较 如果低于阈值比如-70dbm就发起802.11v的BTM Req申请
使用iwpriv %s set SendBTMReq=%02x:%02x:%02x:%02x:%02x:%02x ioctl进到SDK内核态中调用SDK提供的Send_Btm_Req的报文

漫游结果：
终端收到BTM Req之后会进行扫描附近有没有更合适的接入点 如果有合适的接入点终端的BTM RESPONS报文中的结果项为0 然后终端会切换到新的接入点；
如果终端不进行切换也会回复BTM response报文，其中也会带具体的原因码(一般是No suitable BSS transition candidates 没有别的合适的接入点)
不切换的终端我们会间隔一定时间连发3次BTM REQ 如果它都不切那我们不再向它发BTM REQ
/* 定义11v漫游结果 */
#define STAMGR_ROAMRESULT_0 "Success."
#define STAMGR_ROAMRESULT_1 "Unspecified reject reason."
。。。
#define STAMGR_ROAMRESULT_7 "No suitable BSS transition candidates."

漫游优化：
1.边缘行为是指环境中AP信号差，且终端处于漫游决策踢终端下线后，短时间内反复出现上线下线同一个AP的情况(初始判定1分钟内连续下线3次)。针对这种行为目前有以下方案。
	白名单，处于边缘行为的终端，加入白名单，在STAMGR中生效，对于白名单中的MAC可以保持1小时不被AP决策漫游。
2.RSSI值做平滑处理？

拓展：
无线客户端快速发现可用的无线服务<->无线客户端与AP，互相感知各自视角网络拓扑，信息更精准。（11k协议）

无线客户端连接到就近合适的AP<->AP主动识别漫游时机，协同控制漫游切换。（11v协议）

缩短漫游切换业务中断时间<->减少漫游期间重新上线时间（11r协议）。

802.11k协议中定义的Beacon射频测量功能，实现了对2.4GHz和5GHz频段的信道质量及可用资源性能的监控。

802.11v协议中定义的BTM（BSS Transition Management，BSS切换管理）功能用来引导支持802.11v协议的无线客户端离开当前BSS，接入更合适的AP，从而提高802.11v无线客户端的接入质量。

802.11r协议中定义的FT（Fast BSS Transition，快速BSS切换）功能用来减少客户端在漫游过程中的时间延迟，从而降低连接中断概率、提高漫游服务质量。






